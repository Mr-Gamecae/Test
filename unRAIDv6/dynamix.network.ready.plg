<?xml version='1.0' standalone='yes'?>

<!DOCTYPE PLUGIN [
<!ENTITY name      "dynamix.network.ready">
<!ENTITY author    "Bergware">
<!ENTITY version   "2015.05.06">
<!ENTITY pluginURL "https://raw.github.com/bergware/dynamix/master/unRAIDv6/&name;.plg">
]>

<PLUGIN name="&name;" author="&author;" version="&version;" pluginURL="&pluginURL;" plugintype="system">

<!--
The README file.
-->
<FILE Name="/usr/local/emhttp/plugins/&name;/README.md">
<INLINE>
**Dynamix Network Ready**

The Dynamix Network Ready plugin installs as system plugin to ensure it is loaded before any other plugin.
It will wait until the network is ready by pinging an external IP address and overcome connectivity delays with DHCP.
</INLINE>
</FILE>

<!--
The 'network ready' image.
-->
<FILE Name="/usr/local/emhttp/plugins/&name;/images/&name;.png" Type="base64">
<INLINE>
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
RU5ErkJggg==
</INLINE>
</FILE>

<!--
The 'install' script.
-->
<FILE Run="/bin/bash">
<INLINE>
<![CDATA[
# Create plugins folder if not existing
mkdir -p /boot/plugins

# IP address to ping and verify connectivity
ip=8.8.4.4
timer=30
while [[ $timer -gt 0 ]]; do
  if [[ -n $(route -n|awk '/^0.0.0.0/{print $2}') && $(ping -qnc1 $ip|awk '/received/{print $4}') -eq 1 ]]; then
    break
  fi
  ((timer--))
  sleep 1
done
if [[ $timer -eq 0 ]]; then
  echo "No network communication !!!"
fi
]]>
</INLINE>
</FILE>

<!--
The 'remove' script.
-->
<FILE Run="/bin/bash" Method="remove">
<INLINE>
# Remove plugin related files
rm -rf /usr/local/emhttp/plugins/&name;
</INLINE>
</FILE>

</PLUGIN>
